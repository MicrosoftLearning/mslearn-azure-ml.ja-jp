---
lab:
  title: Azure Machine Learning ワークスペースを詳しく見る
---

# Azure Machine Learning ワークスペースを詳しく見る

Azure Machine Learning には、機械学習モデルをトレーニングおよび管理するためのデータ サイエンス プラットフォームが用意されています。 このラボでは、Azure Machine Learning ワークスペースを作成し、ワークスペースを操作するさまざまな方法について学びます。 このラボは、Azure Machine Learning のさまざまなコア機能と開発者ツールの入門編として設計されています。 機能について詳しく知りたい場合は、他にも探索するラボがあります。

## 開始する前に

管理レベルのアクセス権を持つ [Azure サブスクリプション](https://azure.microsoft.com/free?azure-portal=true)が必要です。

## Azure Machine Learning ワークスペースをプロビジョニングする

Azure Machine Learning ''ワークスペース'' では、モデルのトレーニングと管理に必要なすべてのリソースと資産を管理するための中心的な場所が提供されます。**** ワークスペースは、Azure portal で対話型インターフェイスを使用して、または Azure CLI と Azure Machine Learning 拡張機能を使用してプロビジョニングすることができます。 ほとんどの運用シナリオでは、CLI を使用してプロビジョニングを自動化し、反復可能な開発と運用 (*DevOps*) プロセスにリソースのデプロイを組み込めるようにすることをお勧めします。 

この演習では、Azure portal を使用して Azure Machine Learning をプロビジョニングし、すべてのオプションを調べていきます。

1. `https://portal.azure.com/` にサインインします。
2. 次の設定を使用して新しい **Azure Machine Learning** リソースを作成します。
    - **[サブスクリプション]**:"*ご自身の Azure サブスクリプション*"
    - **リソース グループ**: `rg-dp100-labs`
    - **ワークスペース名**: `mlw-dp100-labs`
    - **[リージョン]**: "*最も近い地理的リージョンを選択します*"
    - **[ストレージ アカウント]**: "*ワークスペース用に作成される既定の新しいストレージ アカウントに注目します*"
    - **[キー コンテナー]**: *ワークスペース用に作成される既定の新しいキー コンテナーです*
    - **[Application Insights]**: *ワークスペース用に作成される既定の新しい Application Insights リソースです*
    - **[コンテナー レジストリ]**: なし (*コンテナーにモデルを初めてデプロイするときに、自動的に作成されます*)
3. ワークスペースとそれに関連付けられているリソースが作成されるまで待ちます。通常、これには約 5 分かかります。

> **注**:Azure Machine Learning ワークスペースを作成する場合、いくつかの高度なオプションを使用して、*プライベート エンドポイント*経由のアクセスを制限し、データ暗号化用のカスタム キーを指定できます。 この演習ではこれらのオプションは使用しませんが、注意してください。

## Azure Machine Learning スタジオについて調べる

"Azure Machine Learning スタジオ" は、Azure Machine Learning ワークスペースにアクセスできる Web ベースのポータルです。** Azure Machine Learning スタジオを使用してワークスペース内のすべての資産とリソースを管理できます。

1. **rg-dp100-labs** という名前のリソース グループに移動します。
1. そのリソース グループに、Azure Machine Learning ワークスペース、Application Insights、キー コンテナー、ストレージ アカウントが含まれていることを確認します。
1. Azure Machine Learning ワークスペースを選択します。
1. **[概要]** ページから **[スタジオの起動]** を選択します。 ブラウザーで別のタブが開き、Azure Machine Learning スタジオが開きます。
1. スタジオに表示されるすべてのポップアップを閉じます。
1. スタジオの左側に表示されているさまざまなページに注目してください。 メニューにシンボルのみが表示されている場合は、&#9776; アイコンを選択してメニューを展開し、ページの名前を調べることができます。
1. **[作成]** セクションに注目します。ここには、**[Notebooks]**、**[自動 ML]**、**[デザイナー]** が含まれます。 これらは Azure Machine Learning スタジオ内で独自の機械学習モデルを作成する 3 つの方法です。
1. **[アセット]** セクションに注目します。ここには、 **[データ]** 、 **[ジョブ]** 、 **[モデル]** などが含まれます。 資産は、モデルをトレーニングまたはスコア付けするときに使用または作成するものです。 資産は、モデルのトレーニング、デプロイ、管理に使用し、履歴を追跡するためにバージョン管理できます。
1. **[管理]** セクションに注目します。ここには、**[コンピューティング]** などが含まれます。 これらは、機械学習モデルをトレーニングまたはデプロイするために必要なインフラストラクチャ リソースです。

## AutoML を使用してモデルをトレーニングする

Azure Machine Learning ワークスペースの資産とリソースの使用について調べるために、モデルを試し、トレーニングしてみましょう。

データに基づいてタスクに最適なモデルを見つけてトレーニングするには、**AutoML** オプションを使用するのが簡単です。

> **注**:全体を通して、スタジオを案内するポップアップが表示されることがあります。 すべてのポップアップを閉じて無視し、このラボの手順に集中できます。

1. 使用するトレーニング データ (`https://github.com/MicrosoftLearning/mslearn-azure-ml/raw/refs/heads/main/Labs/02/diabetes-data.zip`) をダウンロードし、圧縮ファイルを展開します。
1. Azure Machine Learning スタジオで、左側のメニューから **[AutoML]** ページを選択します。
1. **[+ 新しい自動 ML ジョブ]** をを選択します。
1. **[基本設定]** ステップで、トレーニング ジョブと実験に一意の名前を付けるか、割り当てられた既定値を使用します。 [**次へ**] を選択します。
1. **[タスクの種類とデータ]** ステップで、タスクの種類として**分類**を選び、**[+ 作成]** を選択してトレーニング データを追加します。
2. **[データ資産の作成]** ページの **[データ型]** ステップで、データ資産に名前 (例: `training-data`) を付け、**[次へ]** を選択します。
1. **[データ ソース]** ステップで、**[ローカル ファイルから]** を選択して、前にダウンロードしたトレーニング データをアップロードします。 [**次へ**] を選択します。
1. **[宛先ストレージの種類]** ステップで、データストアの種類として **Azure Blob Storage** が選択され、データストアとして **workspaceblobstore** が選択されていることを確認します。 [**次へ**] を選択します。
1. **[MLTable の選択]** ステップで、**[フォルダーのアップロード]** を選択し、先ほどダウンロードした圧縮ファイルから抽出したフォルダーを選択します。 [**次へ**] を選択します。
1. データ資産の設定を確認し、**[作成]** を選択します。
1. **[タスクの種類とデータ]** ステップに戻り、アップロードしたデータを選択し、**[次へ]** を選択します。

> **ヒント**: 次のステップに進む前に、タスクの種類として**分類**をもう一度選択することが必要になる場合があります。

1. **[タスク設定]** ステップで、ターゲット列として**糖尿病 (ブール値)** を選んでから、**[追加の構成設定の表示]** オプションを開きます。
1. **[追加の構成]** ペインで、プライマリ メトリックを**正確性**に変更してから、**[保存]** を選択します。
1. **[制限]** オプションを展開し、次のプロパティを設定します。
    * **最大試行回数**: 10
    * **実験のタイムアウト (分)**: 60
    * **イテレーション タイムアウト (分)**: 15
    * **早期終了の有効化**: オン

1. **[テスト データ]** については **[トレーニング/テスト分割]** を選択し、**[テスト データの割合]** が 10 であることを確認します。 [**次へ**] を選択します。
1. **[コンピューティング]** ステップで、コンピューティングの種類が**サーバーレス**で、選択されている仮想マシンのサイズが **Standard_DS3_v2** であることを確認します。 [**次へ**] を選択します。

> **注**:コンピューティング インスタンスとクラスターは、標準の Azure 仮想マシン イメージに基づいています。 この演習では、コストとパフォーマンスの最適なバランスを実現するには、*Standard_DS3_v2* イメージをお勧めします。 サブスクリプションに、このイメージを含まないクォータが存在する場合は、代替イメージを選択します。ただし、大きなイメージはコストを上昇させる可能性があり、小さなイメージはタスクを完了するには十分でない可能性があることに注意してください。 または、Azure 管理者にクォータを拡張するように依頼します。

1. 設定をすべて確認して、**[トレーニング ジョブの送信]** を選択します。

## ジョブを使用して履歴を表示する

ジョブを送信すると、ジョブのページにリダイレクトされます。 ジョブを使用すると、実行したワークロードを追跡し、それらを相互に比較できます。 ジョブは **[実験]** に属していて、それによりジョブの実行をグループ化できます。 

1. **[概要]** のパラメーターでは、(特に) ジョブの状態、作成者、作成日時、実行にかかった時間を確認できることに注意してください。
1. トレーニング ジョブが完了するまでに 10 から 20 分かかります。 完了したら、出力など、個々のコンポーネントの実行の詳細も表示されます。 ジョブ ページを自由に調べて、モデルがどのようにトレーニングされるかを理解してください。

    Azure Machine Learning では、ジョブのプロパティが自動的に追跡されます。 ジョブを使用すると、履歴を簡単に表示して、自分または同僚が既に行ったことを理解できます。
    実験中、ジョブは、比較によって最適なモデルを特定するために、トレーニングするさまざまなモデルを追跡するのに役立ちます。 運用環境では、ジョブを使用して、自動化されたワークロードが想定どおりに実行されたかどうかを確認できます。

## Azure リソースを削除する

Azure Machine Learning を調べ終わったら、不要な Azure のコストを避けるために作成したリソースを削除する必要があります。

1. [Azure Machine Learning スタジオ] タブを閉じて、Azure portal に戻ります。
1. Azure portal の **[ホーム]** ページで、**[リソース グループ]** を選択します。
1. **rg-dp100-labs** リソース グループを選択します。
1. リソース グループの **[概要]** ページの上部で、**[リソース グループの削除]** を選択します。
1. リソース グループ名を入力して、削除することを確認し、**[削除]** を選択します。
